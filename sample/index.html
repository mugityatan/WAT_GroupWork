<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>サンプルページ</title>

        <script src="js/vue.dev.js"></script>
        <script src="js/axios.min.js"></script>
    </head>
    <body>
        <div id="pera">
            <section>
                <h1>サンプルページ</h1>
            </section>
            <div>
                <a href="adduser.php">ユーザー作成</a><br>
                <a href="upload.php">画像のアップロード</a>
            </div>
            <section>
                <div v-for='pera in peras'>
                    <hr>
                    作者：{{pera.applicant}}<br>
                    <img :src='"data/" + pera.pera' style="width: 80%;"><br>
                    タイトル：{{pera.title}}<br>
                    説明：{{pera.description}}
                    <hr>
                </div>
            </section>
        </div>
        <script>
            new Vue({
                el: '#pera',
                data: {
                    // ペラ用配列を空で用意
                    peras: []
                },
                // ページの読み込みが完了したら
                created: function(){
                    // getDataを実行
                    this.getData();
                },
                methods: {
                    // 読み込み完了直後に実行
                    getData: function(){
                        // browsepera.phpを呼び出し情報を取得
                        axios.get('browseperas.php')
                        // 結果をresに代入
                        .then( ( res ) => {
                            // res内のdataに結果JSONが入っているので中身を一つずつ取得
                            for(pera of res.data){
                                // ペラ用配列に追加
                                this.peras.push(pera);
                            }
                        } )
                        .catch( ( res ) => {
                            console.error( res );
                        } );
                    }
                }
            });
        </script>
    </body>
</html>